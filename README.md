# Viral RdRp pHMMs
# Input sequences
We have chosen RNA virus protein sequences, which follow the ICTV taxonomy purely based on a sequence, when analysed by Aiewsakun and Simmonds (2018 PMID:29458427) by “GRAViTy” method. We also added the sequences which the authors listed as exceptions (Aiewsakun and Simmonds, 2018, supplementary material; PMID:29458427). In cases when there were only a small number of sequences in a family-like group or groups of viruses were not mentioned (e.g. recently published as in Shi et al., 2018; PMID: 29618816) in the  “GRAViTy” analysis, we manually searched the NCBI taxonomy and nucleotide databases (April 2018) for more reference sequences, in order to make the pHMM more representative for each group of viruses. In total, there were 1793 RdRp protein and RdRp-containing polyprotein sequences (in my pipeline these are called template sequences). Using these sequences, I created 77 pHMMs.
To exclude non-viral RNA polymerases we used one profile (PF05183; downloaded 2018-08-22; warning - profile has many questionable taxonomy sequences inside) from the Pfam database (Finn et al., 2014; PMID: 24288371) and we made 3 eukaryotic RNA polymerase pHMMs, based on RNA polymerase sequences in the NCBI database (specifying eukaryota taxonomy, and then searched for (RNA dependent) RNA-polymerase, excluding “probable”, “partial”, “hypothetical”, and “predicted”). The NCBI search resulted in 503 sequences (2018-08-23), which were manually curated and then separated into groups: polymerase 1 and 1-like, polymerase 2 and 2-like, polymerase 6 and 6-like, and others. The “others” group was not used in further analysis. This resulted in 82, 42 and 69 in each polymerase group respectively. There were 2275 sequences used in total for viral RdRp and eukaryotic RNA polymerase profiles. 

# Creating pHMMs
Because a lot of viral RdRps are encoded within polyprotein, we wanted to trim the sequences to only the RdRp region. Therefore, the selected sequences were aligned within each group (MUSCLE, v 3.8.31, Edgar, 2004; PMID: 15034147) and then alignments were compared (using HHpred (Zimmermann et al., 2018; PMID: 29258817) with the Pfam and PDB databases (Berman et al., 2000 PMID: 10592235; Finn et al., 2014 PMID: 24288371). Based on the second best match of RdRp (to escape overfitting if the best-match Pfam pHMM would contain sequences from the same group), we cropped the alignment from both sides. The alignments and coordinates for trimming were manually curated based on current knowledge of the families. The cropped alignments were reformatted to Stockholm format using Python (AlignIO from Biopython, Cock et al., 2009 PMID: 19304878) and then the profiles were created using HMMbuild (HMMER 3.1b2; with an option --singlemx, to enable profile building if only one sequence was given; also parameters which differed from the assumptions or had to be set:  MAP (yes) and STATS (LOCAL: MSV / VITERBI / FORWARD) (Eddy et al., 2020)). 
The pHMMs were curated by running HMMsearch (from HMMER 3.1b2, (Eddy et al., 2020)) with template (input) proteins, which were used to create the pHMMs. The results (output) were used to identify the thresholds and their values for the further analysis. 

# Manuscript
These pHMMs are part of 'Identification of RNA virus-derived RdRp sequences in publicly available transcriptomic datasets' by Olendraite and Firth (https://www.path.cam.ac.uk/directory/andrew-firth)

